<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=1200">
  <title>채용안내 | Fine Defense</title>

  <!-- 공통 CSS -->
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/sub-banner.css">

    <style>
    :root {
        --bg: #f5f5f7;
        --card: #ffffff;
        --text: #1d1d1f;
        --subtext: #6e6e73;
        --accent: #0071e3;
        --border: #e5e5ea;
    }

    body {
        background: var(--bg);
        font-family: -apple-system, BlinkMacSystemFont,
                    "Apple SD Gothic Neo", "Noto Sans KR",
                    "Segoe UI", sans-serif;
        margin: 0;
        color: var(--text);
    }

    .recruit-wrapper {
        max-width: 980px;
        margin: 100px auto;
        padding: 0 20px;
    }

    .section-title {
        font-size: 32px;
        font-weight: 700;
        margin-bottom: 24px;
        letter-spacing: -0.02em;
    }

    /* ===============================
        채용공고 카드
    =============================== */
    .recruit-list {
        display: grid;
        grid-template-columns: 1fr;
        gap: 16px;
        margin-bottom: 80px;
    }

    .recruit-item {
      background: transparent;
      box-shadow: none;
      border-radius: 0;
      padding: 24px 8px;
      border-bottom: 1px solid var(--border);
    }

    .recruit-item:last-child {
      border-bottom: none;
    }

    .recruit-item:hover {
      background: #f9f9fb;
      transform: none;
    }

    .recruit-item h3 {
        font-size: 20px;
        margin: 0 0 8px;
        font-weight: 600;
    }

    /* 선택된 채용공고 */
    .recruit-item.active {
      background: #eef5ff;
      border-left: 4px solid var(--accent);
    }

    .recruit-meta {
        font-size: 15px;
        color: var(--subtext);
    }





    /* ===============================
        지원서 카드
    =============================== */
    .apply-wrapper {
      background: transparent;
      padding: 0;
      box-shadow: none;
    }

    .apply-desc {
        font-size: 15px;
        color: var(--subtext);
        margin-bottom: 40px;
    }

    /* ===============================
        입력 필드
    =============================== */
    .form-group {
        margin-bottom: 28px;
    }

    .form-group input,
    .form-group textarea {
        width: 100%;
        padding: 18px 16px;
        font-size: 16px;
        border-radius: 14px;
        border: 1px solid var(--border);
        background: #fff;
        transition: border-color 0.2s;
    }

    .form-group input:focus,
    .form-group textarea:focus {
        outline: none;
        border-color: var(--accent);
    }

    .form-group textarea {
        resize: none;
        height: 140px;
    }

    /* ===============================
        파일 업로드
    =============================== */
    .file-group {
        margin-bottom: 24px;
    }

    .file-group label {
        display: block;
        font-size: 15px;
        font-weight: 600;
        margin-bottom: 6px;
    }

    .file-desc {
        font-size: 13px;
        color: var(--subtext);
        margin-top: 4px;
    }

    input[type="file"] {
        border: none;
        font-size: 14px;
    }

    /* ===============================
        버튼
    =============================== */
    .btn-submit {
        width: 100%;
        padding: 18px;
        font-size: 17px;
        font-weight: 600;
        border-radius: 16px;
        border: none;
        background: var(--accent);
        color: #fff;
        cursor: pointer;
        transition: background 0.2s;
    }

    .btn-submit:hover {
        background: #005ecb;
    }

    /* ===============================
      통합 화이트 카드
    =============================== */
    .recruit-card {
      background: var(--card);
      border-radius: 24px;
      padding: 56px 64px;
      box-shadow: 0 20px 50px rgba(0,0,0,0.08);
    }

    /* 섹션 구분선 */
    .section-divider {
      height: 1px;
      background: var(--border);
      margin: 64px 0;
    }

    /* 개인정보 동의 */
    .privacy-box {
      margin: 40px 0 24px;
      padding: 20px 24px;
      background: #f9f9fb;
      border-radius: 14px;
      font-size: 14px;
    }

    .privacy-check {
      font-weight: 600;
      display: block;
      margin-bottom: 10px;
    }

    .privacy-check input {
      margin-right: 6px;
    }

    .privacy-desc {
      color: var(--subtext);
      line-height: 1.6;
    }

    </style>

</head>

<body>

<!-- 관리자 세션바 -->
<div id="adminBarContainer" data-include="/kr/components/admin-session-bar.html"></div>

<!-- 공통 헤더 -->
<div id="headerContainer" data-include="/kr/components/header.html"></div>

<!-- 서브 배너 -->
<section class="sub-banner">
  <img src="/img/sub-banners/subbanner_support_6.png" alt="채용안내 및 지원">
  <div class="banner-text">
    <h1>채용안내</h1>
    <p>Fine Defense는 미래를 함께 만들어갈 인재를 기다립니다.</p>
  </div>
</section>

<!-- breadcrumb -->
<div class="breadcrumb">
  <a href="/kr/index.html">홈</a> &gt;
  <span class="crumb crumb-level1 active">고객지원</span> &gt;
  <span class="crumb crumb-level2 active">채용안내 및 지원</span>
  <div id="side-tabs"></div>
</div>

<!-- 메인 -->
<div class="recruit-wrapper">

  <!-- 통합 카드 -->
  <div class="recruit-card">

    <!-- 채용공고 -->
    <div class="section-title">채용 공고</div>
    <div class="recruit-list" id="recruitList">
      <!-- 관리자 DB에서 로드 -->
    </div>

    <!-- 지원하기 -->
    <div class="apply-wrapper">
      <div class="section-title">인재 DB 등록</div>
      <div class="apply-desc">
        Fine Defense는 상시 인재 DB를 운영하고 있습니다.<br>
        아래 양식을 통해 인재 정보를 등록해주시면,
        향후 채용이 진행될 경우 우선적으로 검토될 수 있습니다.<br><br>

        이력서는 <strong>PDF 및 이미지(JPG, PNG)</strong> 파일만 업로드 가능하며,
        파일당 최대 용량은 <strong>10MB</strong>입니다.<br>
        등록된 개인정보 및 제출 서류는
        인재 DB 관리 목적을 위해 최대 <strong>12개월</strong>간 보관되며,
        보관 기간 경과 후에는 내부 정책에 따라 파기 또는 분리 보관됩니다.
      </div>

      <div class="form-group">
        <input type="text" id="name" placeholder=" " required>
        <label for="name">이름</label>
      </div>

      <div class="form-group">
        <input type="email" id="email" placeholder=" " required>
        <label for="email">이메일</label>
      </div>

      <div class="form-group">
        <textarea id="message" placeholder=" "></textarea>
        <label for="message">자기소개 / 전달사항</label>
      </div>

      <!-- 파일 업로드 -->
      <div class="file-group">
        <label>이력서 (필수)</label>
        <div class="file-desc">PDF 또는 이미지(JPG, PNG)</div>
        <input type="file" id="file_resume" accept=".pdf,.jpg,.jpeg,.png" required>
      </div>

      <div class="file-group">
        <label>자기소개서 (선택)</label>
        <input type="file" id="file_cover" accept=".pdf,.jpg,.jpeg,.png">
      </div>

      <div class="file-group">
        <label>기타 자료 (선택)</label>
        <input type="file" id="file_portfolio" accept=".pdf,.jpg,.jpeg,.png">
        <div class="file-desc">포트폴리오, 경력증빙 등</div>
      </div>

      <!-- 개인정보 수집·이용 동의 -->
      <div class="privacy-box">
        <label class="privacy-check">
          <input type="checkbox" id="agree_privacy" required>
          개인정보 수집·이용에 동의합니다. (필수)
        </label>
        <div class="privacy-desc">
          • 수집 항목: 이름, 이메일, 지원 내용, 이력서 및 첨부 파일<br>
          • 수집 목적: 인재 DB 관리 및 향후 채용 검토<br>
          • 보관 기간: 인재 DB 관리 목적을 위해 최대 12개월간 보관되며,
                      보관 기간 경과 후에는 내부 정책에 따라 파기 또는 분리 보관됩니다.<br><br>
          ※ 개인정보 수집·이용에 대한 동의를 거부할 수 있으나, 동의하지 않을 경우 인재 DB 등록이 제한됩니다.
        </div>
      </div>

      <button class="btn-submit" onclick="submitApplication()">인재 DB 등록</button>
    </div>
  </div>
</div>

<!-- 공통 푸터 -->
<div data-include="/kr/components/footer.html"></div>

<!-- 공통 스크립트 -->
<script src="/js/include.js"></script>
<script src="/js/session_timer.js"></script>
<script src="/js/language.js"></script>
<script src="/js/nav.js"></script>

<script>
/* 채용공고 목록 로드 */
async function loadRecruitList() {
  const res = await fetch("/api/recruit/list");
  const list = await res.json();

  const wrap = document.getElementById("recruitList");
  wrap.innerHTML = "";

  list.forEach(item => {
    const div = document.createElement("div");
    div.className = "recruit-item";
    div.innerHTML = `
      <h3>${item.title}</h3>
      <div class="recruit-meta">
        ${item.employment_type} · ${item.career_level} · ${item.location}
      </div>
    `;

    div.onclick = () => {
      location.href = `/kr/support/recruit/recruit-view.html?id=${item.id}`;
    };

    wrap.appendChild(div);
  });
}

/* 지원서 제출 */
async function submitApplication() {

  if (!document.getElementById("agree_privacy").checked) {
    alert("개인정보 수집·이용에 동의하셔야 인재 DB 등록이 가능합니다.");
    return;
  }

  const resume = document.getElementById("file_resume").files[0];
  if (!resume) {
    alert("이력서를 첨부해주세요.");
    return;
  }

  const MAX_SIZE = 10 * 1024 * 1024;
  if (resume.size > MAX_SIZE) {
    alert("이력서는 최대 10MB까지 업로드 가능합니다.");
    return;
  }

  const formData = new FormData();
  formData.append("name", document.getElementById("name").value);
  formData.append("email", document.getElementById("email").value);
  formData.append("message", document.getElementById("message").value);

  formData.append("resume", document.getElementById("file_resume").files[0]);
  if (document.getElementById("file_cover").files[0])
    formData.append("cover", document.getElementById("file_cover").files[0]);
  if (document.getElementById("file_portfolio").files[0])
    formData.append("portfolio", document.getElementById("file_portfolio").files[0]);

  const res = await fetch("/api/recruit/apply", {
    method: "POST",
    body: formData
  });

  if (res.ok) {
    alert("인재 정보가 정상적으로 등록되었습니다.");
    location.reload();
  } else {
    alert("등록 중 오류가 발생했습니다.");
  }
}

loadRecruitList();
</script>

</body>
</html>
