<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>공지사항 | 화인디펜스</title>

  <!-- 공통 CSS -->
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/sub-banner.css">

  <style>
    /* ===============================
       공지사항 섹션
    =============================== */
    .notice-section {
      max-width: 1000px;
      margin: 50px auto 100px;
      padding: 30px 40px;
      background: #ffffff;
      border-radius: 14px;
      box-shadow: 0 3px 12px rgba(0,0,0,0.06);
    }

    .notice-section h1 {
      font-size: 2rem;
      font-weight: 800;
      color: #0f2679;
      margin-bottom: 20px;
      text-align: center;
    }

    /* ===============================
       공지사항 테이블
    =============================== */
    table.notice-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 30px;
      font-size: 1rem;
    }

    table.notice-table th,
    table.notice-table td {
      padding: 14px;
      border-bottom: 1px solid #ddd;
      text-align: left;
    }

    table.notice-table th {
      background: #0f2679;
      color: #fff;
      font-weight: 600;
    }

    table.notice-table tr:hover td {
      background: #f3f6ff;
      cursor: pointer;
    }
  </style>
</head>

<body>

<!-- 헤더 -->
<div id="header"></div>

<!-- 서브 배너 -->
<section class="sub-banner">
  <img src="/img/sub-banners/pr-1_v2.jpg" alt="공지사항 배너" />
  <div class="banner-text">
    <h1>홍보센터</h1>
    <p>화인디펜스의 주요 공지 및 안내사항을 확인하세요.</p>
  </div>
</section>

<!-- breadcrumb -->
<div class="breadcrumb">
  <a href="/kr/index.html">홈</a> &gt;
  <span class="crumb crumb-level1">홍보센터</span> &gt;
  <span class="crumb crumb-level2">공지사항</span>
  <div id="side-tabs" class="side-tabs"></div>
</div>

<!-- 본문 -->
<section class="notice-section">
  <h1>공지사항</h1>

  <table class="notice-table" id="noticeTable">
    <thead>
      <tr><th>번호</th><th>제목</th><th>작성일</th></tr>
    </thead>
    <tbody>
      <tr><td colspan="3">불러오는 중...</td></tr>
    </tbody>
  </table>
</section>

<!-- 푸터 -->
<div id="footer"></div>

<!-- 공통 네비게이션 스크립트 -->
<script src="/js/nav.js"></script>

<script>
  async function loadNotices() {
    try {
      const res = await fetch(`/api/posts/notice?lang=kr`);
      const data = await res.json();
      const tbody = document.querySelector("#noticeTable tbody");

      if (!data.length) {
        tbody.innerHTML = `
          <tr>
            <td colspan="3" style="text-align:center;color:#777;">
              등록된 공지사항이 없습니다.
            </td>
          </tr>`;
        return;
      }

      tbody.innerHTML = data.map((n, i) => `
        <tr onclick="location.href='/kr/sub/pr/notice/notice-view.html?id=${n.id}'">
          <td>${data.length - i}</td>
          <td>${n.title}</td>
          <td>${new Date(n.created_at).toLocaleDateString()}</td>
        </tr>
      `).join("");

    } catch (e) {
      console.error("공지사항 로드 오류:", e);
      document.querySelector("#noticeTable tbody").innerHTML = `
        <tr><td colspan="3">불러오기 중 오류가 발생했습니다.</td></tr>`;
    }
  }

  loadNotices();
</script>

</body>
</html>
