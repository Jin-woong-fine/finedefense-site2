<script>
  // URLì—ì„œ postId ì¶”ì¶œ (?id=3)
  const urlParams = new URLSearchParams(window.location.search);
  const postId = urlParams.get("id");

  if (!postId) {
    document.querySelector(".news-post-container").innerHTML =
      "<p style='text-align:center;color:#555;'>ì˜ëª»ëœ ì ‘ê·¼ì…ë‹ˆë‹¤.</p>";
  } else {
    loadPost(postId);
  }

  async function loadPost(id) {
    try {
      // ğŸ”¥ API_URL ì—†ì´ ìƒëŒ€ê²½ë¡œë¡œ ìš”ì²­
      const res = await fetch(`/api/posts/${id}`);
      const post = await res.json();

      if (!post || !post.id) {
        document.getElementById("postContent").innerHTML =
          "<p style='color:#999;'>ê²Œì‹œë¬¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>";
        return;
      }

      // ì œëª©, ë©”íƒ€ ì •ë³´
      document.getElementById("postTitle").textContent = post.title;
      document.getElementById("postCategory").textContent = categoryName(post.category);
      document.getElementById("postDate").textContent = new Date(post.created_at).toLocaleDateString();
      document.getElementById("postAuthor").textContent = post.author_name || "ê´€ë¦¬ì";

      // ëŒ€í‘œ ì´ë¯¸ì§€
      if (post.main_image) {
        document.getElementById("postImage").innerHTML =
          `<img src="${post.main_image}" alt="ëŒ€í‘œ ì´ë¯¸ì§€">`;
      }

      // ë³¸ë¬¸ ë‚´ìš© (Quillì—ì„œ ì €ì¥í•œ HTML ê·¸ëŒ€ë¡œ)
      document.getElementById("postContent").innerHTML = post.content;

    } catch (err) {
      console.error(err);
      document.getElementById("postContent").innerHTML =
        "<p style='color:red;'>ê²Œì‹œë¬¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>";
    }
  }

  // ì¹´í…Œê³ ë¦¬ í•œê¸€ ë³€í™˜
  function categoryName(code) {
    switch(code) {
      case "news": return "ë‰´ìŠ¤ë£¸";
      case "notice": return "ê³µì§€ì‚¬í•­";
      case "gallery": return "ê°¤ëŸ¬ë¦¬";
      case "cert": return "ì¸ì¦ ë° íŠ¹í—ˆ";
      case "catalog": return "ì¹´íƒˆë¡œê·¸";
      default: return "ê²Œì‹œë¬¼";
    }
  }
</script>
