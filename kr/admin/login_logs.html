<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>로그인 기록 | 관리자</title>
  <link rel="stylesheet" href="./css/admin.css">

  <style>
    table { width:100%; border-collapse: collapse; }
    th, td { padding:10px; border-bottom:1px solid #ddd; }
    th { background:#eef1f7; font-weight:600; }
    .success { color:green; font-weight:bold; }
    .fail { color:crimson; font-weight:bold; }
  </style>
</head>

<body>

<div id="sidebar"></div>

<div class="main">

  <div class="topbar">
    <h2>로그인 기록</h2>
    <div>
      <button class="btn btn-primary" onclick="location.href='../index.html'">홈으로</button>
      <button id="logoutBtn" class="btn btn-danger">로그아웃</button>
    </div>
  </div>

  <section class="panel">
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>아이디</th>
          <th>IP</th>
          <th>User Agent</th>
          <th>결과</th>
          <th>시간</th>
        </tr>
      </thead>
      <tbody id="logsTable"></tbody>
    </table>
  </section>

</div>

<script src="/kr/admin/js/common_auth.js"></script>
<script src="/kr/admin/js/sidebar.js"></script>
<script>
  requireAdminOrSuperadmin();
  loadSidebar("login_logs");

  async function loadLogs() {
    const res = await fetch("/api/logs/login", {
      headers: { Authorization: "Bearer " + localStorage.getItem("token") }
    });
    const logs = await res.json();

    const tbody = document.getElementById("logsTable");
    tbody.innerHTML = logs.map(l => `
      <tr>
        <td>${l.id}</td>
        <td>${l.username || "-"}</td>
        <td>${l.ip}</td>
        <td>${l.ua}</td>
        <td class="${l.status}">${l.status}</td>
        <td>${l.created_at}</td>
      </tr>
    `).join("");
  }

  loadLogs();
  document.getElementById("logoutBtn").onclick = logout;
</script>

</body>
</html>
