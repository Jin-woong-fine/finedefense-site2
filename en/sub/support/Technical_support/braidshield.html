<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Braid Shield Calculator</title>

<style>
:root {
  --accent: #007aff;
  --border: #e5e5ea;
  --bg: #ffffff;
  --bg-subtle: #f5f5f7;
  --text: #1c1c1e;
  --text-muted: #6e6e73;
}

* {
  box-sizing: border-box;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text",
               "Apple SD Gothic Neo", system-ui, sans-serif;
  font-size: 14px;
  color: var(--text);
  line-height: 1.6;
}

/* ===== Typography ===== */

h1 {
  font-size: 22px;
  font-weight: 600;
  margin-bottom: 20px;
}

h2 {
  font-size: 17px;
  font-weight: 600;
  margin-bottom: 16px;
}

label {
  font-size: 13px;
  font-weight: 500;
  color: var(--text-muted);
}

.hint {
  display: block;
  font-size: 11px;
  font-weight: 400;
  color: var(--text-muted);
  margin-top: 2px;
}

/* ===== Layout ===== */

.calculator {
  background: var(--bg-subtle);
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 28px;
}

/* Grid row */
.calc-row {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 24px;
  align-items: stretch;
}

/* Each grid cell */
.calc-row > div {
  display: flex;
  flex-direction: column;
}

.calc-row > div {
  display: flex;
  flex-direction: column;
  gap: 6px;   /* 핵심 */
}

/* ===== Inputs & Selects ===== */

.calc-row input,
.calc-row select {
  padding: 10px 12px;
  font-size: 14px;
  border-radius: 10px;
  border: 1px solid var(--border);
  background-color: #fff;
  color: var(--text);
}

.calc-row label + input,
.calc-row label + select {
  margin-top: 6px;
}


/* Select appearance */
.calc-row select {
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  cursor: pointer;

  background-image:
    linear-gradient(45deg, transparent 50%, var(--text-muted) 50%),
    linear-gradient(135deg, var(--text-muted) 50%, transparent 50%);
  background-position:
    calc(100% - 18px) 50%,
    calc(100% - 13px) 50%;
  background-size: 5px 5px;
  background-repeat: no-repeat;
  padding-right: 32px;
}

.calc-row select:focus,
.calc-row input:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 4px rgba(0, 122, 255, 0.15);
}

/* Button */
.calc-row button {
  padding: 12px 22px;
  background: var(--accent);
  color: #fff;
  border: none;
  border-radius: 12px;
  font-weight: 600;
  cursor: pointer;
}

/* ===== Wire Diameter Group ===== */

.wire-group {
  display: flex;
  flex-direction: column;
}

.wire-options {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
  margin-top: 6px;
}

.wire-options select,
.wire-options input {
  height: 42px;
  margin: 0;
}

.wire-hint {
  font-size: 11px;
  color: var(--text-muted);
  margin-top: 4px;
  opacity: 0.85;
}

/* ===== Table ===== */

table {
  width: 100%;
  margin-top: 24px;
  border-collapse: collapse;
  font-size: 13px;
}

th, td {
  padding: 10px 12px;
  border-bottom: 1px solid var(--border);
  text-align: right;
}

th:first-child,
td:first-child {
  text-align: left;
}

/* ===== Coverage Colors ===== */

.coverage-high {
  color: #2ecc71;
  font-weight: 600;
}

.coverage-mid {
  color: #f1c40f;
  font-weight: 600;
}

.coverage-low {
  color: #e74c3c;
  font-weight: 600;
}

/* ===== Notes & Formula ===== */

.note {
  margin-top: 14px;
  font-size: 12px;
  color: var(--text-muted);
}

.formula-block {
  margin-top: 32px;
}

.formula-block h3 {
  font-size: 15px;
  font-weight: 600;
  margin-bottom: 12px;
}

.formula-block p {
  font-size: 13px;
  color: var(--text-muted);
  margin-bottom: 10px;
}

.formula-block .formula {
  color: var(--text);
  font-family: system-ui, -apple-system, BlinkMacSystemFont;
}

.calc-row button {
  align-self: stretch;
  margin-top: 10px;
}

</style>
</head>

<body>

<section>
<h1>Braid Shield Calculator</h1>

<div class="calculator">

  <div class="calc-row">
    <div>
      <label>Braid Mode</label>
      <select id="braidMode">
        <option value="shielding" selected>
          EMI / Shielding (IEC·MIL)
        </option>
        <option value="jis">
          JIS Method (Conservative)
        </option>
        <option value="mechanical">
          Mechanical / Structural
        </option>
      </select>
    </div>

    <div class="wire-group">
      <label>Wire Diameter (mm)</label>

      <div class="wire-options">
        <select id="wireDiaSelect" onchange="setWireDia()">
          <option value="">Select wire diameter</option>
          <option value="0.08">0.08</option>
          <option value="0.10">0.10</option>
          <option value="0.12">0.12</option>
          <option value="0.16">0.16</option>
          <option value="0.19">0.19</option>
          <option value="0.20">0.20</option>
          <option value="0.25">0.25</option>
          <option value="0.30">0.30</option>
          <option value="0.32">0.32</option>
          <option value="0.40">0.40</option>
          <option value="0.50">0.50</option>
          <option value="0.51">0.51</option>
          <option value="0.64">0.64</option>
          <option value="0.80">0.80</option>
          <option value="1.00">1.00</option>
        </select>

        <input type="number"
              id="wireDia"
              step="0.01"
              placeholder="Manual input" />
      </div>

      <div class="wire-hint">
        Select from list or enter manually
      </div>
    </div>

    <div>
        <label>
        Ends per Carrier
        <span class="hint">Common: 8, 12, 16, 24</span>
        </label>
        <input type="number" id="ends" placeholder="e.g. 16">
    </div>

    <div>
        <label>
        Number of Carriers
        <span class="hint">Common: 16, 24, 32, 36, 48</span>
        </label>
        <input type="number" id="carriers" placeholder="e.g. 24">
    </div>

    <div>
        <label>
        Braid Pitch (mm)
        <span class="hint">Typical: 6 – 12 mm</span>
        </label>
        <input type="number" id="pitchInput" step="0.1" placeholder="e.g. 8.0">
    </div>

    <div>
      <label>Core Diameter (mm)</label>
      <input type="number" id="coreDia" step="0.01" placeholder="e.g. 5.0">
    </div>

    <div>
      <button onclick="calculateBraid()">Calculate</button>
    </div>
  </div>

  <table>
    <thead>
      <tr>
        <th>Item</th>
        <th>Result</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Picks per Inch (PPI)</td>
        <td id="ppiResult">-</td>
      </tr>
      <tr>
        <td>Braid Angle</td>
        <td id="angle">-</td>
      </tr>
      <tr>
        <td>Coverage</td>
        <td id="coverage">-</td>
      </tr>
      <tr>
        <td>Estimated Outer Diameter</td>
        <td id="outerDia">-</td>
      </tr>
    </tbody>
  </table>

  <div class="note">
    ※ Braid angle should typically be between 18° and 40°.<br>
    ※ This calculator is provided for reference purposes only.  
    Actual braid coverage and outer diameter may vary depending on compaction and manufacturing conditions.
  </div>

</div>

  <div class="calculator formula-block">
    <h3>Calculation Method</h3>

    <p>
      The braid geometry is calculated based on standard helical braid theory.
      Braid angle and outer diameter are derived from the braid pitch and
      core geometry.
    </p>

    <p class="formula">
      Braid angle:<br>
      α = arctan [ π · (D<sub>c</sub> + 2d) / P ]
    </p>

    <p class="formula">
      Estimated outer diameter after braiding:<br>
      D<sub>out</sub> = D<sub>c</sub> + 2 · d · cos α
    </p>

    <p>
      The coverage value is automatically calculated using an internal model
      selected based on braid geometry to ensure physically valid results.
      Depending on wire diameter, core size, and braid density, the calculation
      adapts between overlapping coverage and circumferential fill interpretation.
    </p>

    <p>
      Actual braid coverage and outer diameter may vary depending on
      compaction and manufacturing conditions.
    </p>

    <p>
      where d is the wire diameter, D<sub>c</sub> is the core diameter,
      and P is the braid pitch.
    </p>
  </div>



</section>

<script>
  function calculateBraid() {
    const d = parseFloat(document.getElementById("wireDia").value);
    const E = parseFloat(document.getElementById("ends").value);
    const C = parseFloat(document.getElementById("carriers").value);
    const P = parseFloat(document.getElementById("pitchInput").value);
    const Dc = parseFloat(document.getElementById("coreDia").value);
    const mode = document.getElementById("braidMode").value;

    if (!d || !E || !C || !P || !Dc) return;

    /* ===============================
      공통 계산
    =============================== */
    const totalEnds = E * C;
    const PPI = (25.4 * (C / 2)) / P;

    const d_in  = d  / 25.4;
    const Dc_in = Dc / 25.4;
    const P_in  = P  / 25.4;

    // 기본 편조각 계산 (기하학적)
    const tana = (Math.PI * (Dc_in + 2 * d_in)) / P_in;
    let a = Math.atan(tana) * 180 / Math.PI;

    let K = 0;
    let coverageNote = "";

    /* ===============================
      MODE 분기
    =============================== */
    if (mode === "shielding") {
      // IEC / MIL 차폐용 (겹침 인정)
      const aEff = Math.min(Math.max(a, 35), 55);

      const F =
        (E * d_in * (C / 2)) /
        (Math.sin(aEff * Math.PI / 180) * Math.PI * (Dc_in + d_in));

      K = 100 * (2 * F - F * F);
      K = Math.max(0, Math.min(K, 100));

      a = aEff;
      coverageNote = "IEC / MIL method (overlap included)";

    } else if (mode === "jis") {
      // JIS 방식 (겹침 미인정, 투영폭 기준)
      const circumference = Math.PI * (Dc + 2 * d);
      const projectedWidth =
        totalEnds * d * Math.cos(a * Math.PI / 180);

      K = 100 * (projectedWidth / circumference);
      K = Math.max(0, Math.min(K, 100));

      coverageNote = "JIS method (projected coverage only)";

    } else {
      // Mechanical / Structural
      const circumference = Math.PI * (Dc + 2 * d);
      const projectedWidth =
        totalEnds * d * Math.cos(a * Math.PI / 180);

      K = 100 * (projectedWidth / circumference);
      K = Math.max(0, Math.min(K, 150));

      coverageNote = "Structural coverage (mechanical support)";
    }

    /* ===============================
      외경 계산 (공통)
    =============================== */
    const Dout = Dc + 2 * d * Math.cos(a * Math.PI / 180);

    /* ===============================
      결과 출력
    =============================== */
    document.getElementById("ppiResult").textContent =
      PPI.toFixed(1);

    document.getElementById("angle").textContent =
      a.toFixed(2) + " °";

    const covEl = document.getElementById("coverage");
    covEl.textContent = K.toFixed(1) + " %";

    // Coverage 색상
    covEl.className = "";
    if (K >= 80) covEl.classList.add("coverage-high");
    else if (K >= 50) covEl.classList.add("coverage-mid");
    else covEl.classList.add("coverage-low");

    // ⭐ 4번: coverage 설명 툴팁
    covEl.title = coverageNote;

    document.getElementById("outerDia").textContent =
      Dout.toFixed(2) + " mm";

    /* ===============================
      각도 경고 (모드별)
    =============================== */
    if (mode !== "mechanical" && (a < 30 || a > 55)) {
      alert("Warning: Braid angle is outside the typical shielding range (30°–55°).");
    }
  }



function setWireDia() {
  const select = document.getElementById("wireDiaSelect");
  const input = document.getElementById("wireDia");

  if (select.value) {
    input.value = select.value;
  }
}
</script>


</body>
</html>
