<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Newsroom | Fine Defense</title>

  <!-- κ³µν†µ CSS -->
  <link rel="stylesheet" href="/css/header.css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/sub-banner.css">

  <style>
    .news-container {
      max-width: 1200px;
      margin: 50px auto 25px;
      padding: 0 20px;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 28px;
    }

    .news-card {
      background: #fff;
      border-radius: 14px;
      overflow: hidden;
      box-shadow: 0 3px 12px rgba(0,0,0,0.08);
      cursor: pointer;
      transition: 0.2s;
    }

    .news-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.12);
    }

    .news-thumb {
      width: 100%;
      height: 180px;
      object-fit: cover;
      background: #eee;
    }

    .news-content {
      padding: 18px 20px 24px;
    }

    .news-title {
      font-size: 1.05rem;
      font-weight: 700;
      min-height: 48px;
      margin-bottom: 12px;
      line-height: 1.35;
    }

    .news-date {
      font-size: 0.85rem;
      color: #777;
    }

    /* pagination */
    .pagination {
      display: flex;
      justify-content: center;
      gap: 6px;
      margin-bottom: 60px;
    }

    .pagination button {
      padding: 7px 12px;
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.9rem;
    }

    .pagination button.active {
      background: #0f2679;
      color: #fff;
      border-color: #0f2679;
    }
  </style>
</head>

<body>

  <!-- Admin Session Bar -->
  <div id="adminBarContainer" data-include="/en/components/admin-session-bar.html"></div>

  <!-- Common Header -->
  <div id="headerContainer" data-include="/en/components/header.html"></div>

  <!-- Sub Banner -->
  <section class="sub-banner">
    <img src="/img/sub-banners/pr-1_v2.jpg" alt="Media Center Banner" />
    <div class="banner-text">
      <h1>Media Center</h1>
      <p>Explore the latest updates and promotional materials from Fine Defense.</p>
    </div>
  </section>

  <!-- Breadcrumb -->
  <div class="breadcrumb">
    <a href="/en/index.html">Home</a> &gt;
    <span class="crumb crumb-level1">Media Center</span> &gt;
    <span class="crumb crumb-level2">Newsroom</span>
    <div id="side-tabs" class="side-tabs"></div>
  </div>



  <!-- λ‰΄μ¤ λ©λ΅ -->
  <div class="news-container" id="newsContainer"></div>

  <!-- νμ΄μ§€λ„¤μ΄μ… -->
  <div class="pagination" id="pagination"></div>

    <!-- κ³µν†µ ν‘Έν„° -->
    <div data-include="/en/components/footer.html"></div>



<script>
  let currentPage = 1;
  const pageSize = 9;

  document.addEventListener("DOMContentLoaded", () => loadNews(1));

  async function loadNews(page) {
    currentPage = page;

    const res = await fetch(`/api/posts/list/news?lang=en`);
    const data = await res.json();

    console.log("π”¥ μ„λ²„ μ‘λ‹µ:", data);

    // π”¥ λ°°μ—΄ λλ” κ°μ²΄ λ¨λ‘ λ€μ‘
    const list = Array.isArray(data)
      ? data
      : (Array.isArray(data.list) ? data.list : []);

      if (!list.length) {
        document.getElementById("newsContainer").innerHTML =
          "<p>No news articles available.</p>";
        renderPagination(1, 1);
        return;
      }


    // νμ΄μ§€ κ³„μ‚°
    const totalPages = Math.ceil(list.length / pageSize);
    const sliced = list.slice((page - 1) * pageSize, page * pageSize);

    const box = document.getElementById("newsContainer");

    box.innerHTML = sliced
      .map((v) => {
        const img = v.main_image || "/img/no-image.jpg";
        const date = v.created_at?.substring(0, 10) || "";

        return `
          <div class="news-card" onclick="openNews(${v.id})">
            <img src="${img}" class="news-thumb">
            <div class="news-content">
              <div class="news-title">${v.title}</div>
              <div class="news-date">${date}</div>
            </div>
          </div>
        `;
      })
      .join("");

    renderPagination(totalPages, currentPage);
  }

  function openNews(id) {
    location.href = `/en/sub/pr/newsroom/news-view.html?id=${id}`;
  }

  function renderPagination(totalPages, current) {
    const p = document.getElementById("pagination");
    p.innerHTML = "";

    if (totalPages <= 1) return;

    if (current > 1) {
      p.innerHTML += `<button onclick="loadNews(${current - 1})">μ΄μ „</button>`;
    }

    for (let i = 1; i <= totalPages; i++) {
      p.innerHTML += `
        <button class="${i === current ? "active" : ""}"
                onclick="loadNews(${i})">${i}</button>
      `;
    }

    if (current < totalPages) {
      p.innerHTML += `<button onclick="loadNews(${current + 1})">λ‹¤μ</button>`;
    }
  }
</script>


    <!-- κ³µν†µ μ¤ν¬λ¦½νΈ -->
    <script src="/js/include.js"></script>
    <script src="/js/session_timer.js"></script>
    <script src="/js/language.js"></script>
    <script src="/js/nav.js"></script>


</body>
</html>
